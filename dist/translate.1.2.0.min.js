!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(["translate"],t):e.Translate=t(e)}("object"==typeof window?window:main,function(e){var t=(e&&e.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},function(e,t){for(var n in t)t.hasOwnProperty(n)&&e&&!e.hasOwnProperty(n)&&(e[n]=t[n])}),n=function(e,t){if(t.length)for(var n=0;n<t.length;e.push(t[n]),n++);},a=function(r){var o=this;if(!r||r&&!r.default||r&&!r.namespace)throw Error("You must config 'Translate' at least two of Attrs {default: String,namespace: String} in your project.");if(!o instanceof a)return new a(r);var i={namespace:r.namespace,userSetLang:r.default,domTransSourceName:r.dataBinder||"langdata",elementRegTag:"domRegistered"},l={totalLangData:{},allLanguageMarks:[],domList:[],translateWrapper:"translateWrapper",translateTextTag:{begin:"@{",end:"}"}};o.Name="Translate",o.Tag=o.Name+"-",o.Version="1.1.0",o.language=null,o.namespace=i.namespace,o.defaultNS="default";var u=function(){var t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n={attributes:!0,childList:!0,characterData:!0},a=Array.apply(null,arguments),r=a[0],o=e.document.querySelector("string"==typeof a[0]?(r=a[1],a[0]):"body"),i=new t(function(e){console.log(e),e.forEach(r)});return i.observe(o,n),i},c=function(e,t){return new RegExp(l.translateTextTag.begin+e+l.translateTextTag.end,t)},s=function(t,n){var a=e.document.createElement("b");return a.setAttribute(t,n),a},g=function(e){return e.replace(c(".*?","g"),function(e){var t,n=e.match(c("(.+S?)"));if(n=String.prototype.replace.call(n[1],/\s/g,""),n.indexOf("|")!=-1){var a=n.split("|");t=v(s(a[1],a[0]))}else t=v(s(o.defaultNS,n));return t})},f=function(t){var n=e.document.querySelectorAll("["+l.translateWrapper+"]");n=Array.prototype.filter.call(n,function(e){return!e[l.translateWrapper]}),n.length<1||(n.forEach(function(e,t){var n=g(e.innerHTML);e.innerHTML="",e[l.translateWrapper]=!0,e.appendChild(w(n))}),t&&t())},d=function(e,t){i.userSetLang=e,"function"==typeof t&&t()},p=function(){return a.prototype.language=l.totalLangData[i.userSetLang]},m=function(e){e=e.trim();var t=e.split("."),n=null===o.language?p():o.language;for(var a in t){if(!n[t[a]]){console.log("["+e+"] 未匹配到目标语言字段，请检查。"),n="Bad Translation!";break}n=n[t[a]]}return n},L=function(e){return Array.prototype.slice.call(e.querySelectorAll("["+o.namespace+"]"))},y=function(e){l.domList.forEach(function(e,t){e[i.elementRegTag]=!0}),n(l.domList,e,i.elementRegTag)},h=function(t){var n,a,r;return r=e.document.getElementById("frame_range"),null===r&&(r=e.document.createElement("iframe"),r.setAttribute("id","frame_range"),r.setAttribute("style","display: none;"),e.document.body.appendChild(r)),a=e.document.createRange(),a.selectNode(r),n=a.createContextualFragment(t)},v=function(t){var n=e.document.createElement("div");return n.appendChild(t),n.innerHTML},T=function(e){var t=L(e);console.log(t),t.length<1||(console.log(l.domList),t=t.filter(function(e){return!e[i.elementRegTag]}),t.forEach(function(e,n){if(l.totalLangData[i.userSetLang]){var a=t[n][i.domTransSourceName]=e.getAttribute(o.namespace);e.innerHTML=m(a)}}),y(t),console.log(o.namespace),console.log(l.domList))},b=function(e){var t=h(e);return T(t),t},w=function(e){var t=h(e);return t},S=function(){console.log("刚加载"),p(),T(document)},M=function(e){e=e.trim(),d(e,p),console.log(l.domList),l.domList.forEach(function(e,t){var n=l.domList[t][i.domTransSourceName];console.log(e),console.log(n),e.innerHTML=m(n),console.log(e)})},E=function(e,n){if(1==e.length)if("object"==typeof e)t(l.totalLangData,e[0]);else try{e=JSON.parse(e[0]),t(l.totalLangData,e)}catch(e){console.log(e)}else if(2==e.length){if("string"!=typeof e[0])throw Error("The [translation] parameters should be ([string],[object | JSON string ]) or ([object | JSON string]) !");var a={};a[e[0]]=e[1],t(l.totalLangData,a)}l.allLanguageMarks=[];for(var r in l.totalLangData)l.allLanguageMarks.push(r);n&&n()},O=function(e){return console.log(l.allLanguageMarks.join(",")),console.log(l.allLanguageMarks.join(",").indexOf(e)),l.allLanguageMarks.join(",").indexOf(e)!=-1};return o.translation=function(){var e=arguments;E(e,S);u(function(e){console.log(e)});return o},o.use=function(e){if("string"!=typeof e||e&&""==e.trim())throw Error("To Translate 'use' function parameter must be a string！");return O(e)?void M(e):void console.log("The language tag ["+e+"] has not been registered!")},o.domNodes=function(e){return b(e)},o.init=function(){f()},o.init(),o.getAllLanguages=function(){return l.totalLangData},o.getElementRegistered=function(){return l.domList},o};return a});